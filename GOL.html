<!DOCTYPE html>
<html>
<head>
  <title>Conway's Game of Life</title>
  <style>
    canvas {
      border: 2px solid #b33a4c;
      display: block;
      margin: 20px auto;
    }
    #controls {
      text-align: center;
      margin-bottom: 20px;
    }
    #speed {
      width: 200px;
      margin-left: 10px;
    }
    #speed-value {
      font-weight: bold;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div id="controls">
    <button id="startStop">Start</button>
    <label for="speed">Speed:</label>
    <input type="range" id="speed" min="100" max="1000" step="50" value="500">
    <span id="speed-value">500 ms</span>
  </div>
  <canvas id="gameCanvas" width="400" height="400"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const rows = 20;
    const cols = 20;
    const cellSize = canvas.width / cols;
    let grid = Array.from({ length: rows }, () => Array(cols).fill(0));
    
    // Randomize initial grid
    function randomizeGrid() {
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          grid[r][c] = Math.random() > 0.7 ? 1 : 0;
        }
      }
    }
    
    function drawGrid() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          ctx.fillStyle = grid[r][c] ? '#b33a4c' : '#fff';
          ctx.fillRect(c*cellSize, r*cellSize, cellSize-1, cellSize-1);
        }
      }
    }
    
    function updateGrid() {
      const next = grid.map(arr => [...arr]);
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          let neighbors = 0;
          for (let i=-1; i<=1; i++) {
            for (let j=-1; j<=1; j++) {
              if(i===0 && j===0) continue;
              const nr = r+i, nc = c+j;
              if(nr>=0 && nr<rows && nc>=0 && nc<cols) neighbors += grid[nr][nc];
            }
          }
          if(grid[r][c] && (neighbors<2 || neighbors>3)) next[r][c] = 0;
          if(!grid[r][c] && neighbors===3) next[r][c] = 1;
        }
      }
      grid = next;
      drawGrid();
    }
    
    randomizeGrid();
    drawGrid();

    let interval = 500;
    let simulation;

    const speedSlider = document.getElementById('speed');
    const speedValue = document.getElementById('speed-value');
    const startStopBtn = document.getElementById('startStop');

    function startSimulation() {
      clearInterval(simulation);
      simulation = setInterval(updateGrid, interval);
      startStopBtn.textContent = "Stop";
    }

    function stopSimulation() {
      clearInterval(simulation);
      startStopBtn.textContent = "Start";
    }

    startStopBtn.addEventListener('click', () => {
      if(simulation) stopSimulation();
      else startSimulation();
    });

    speedSlider.addEventListener('input', () => {
      interval = parseInt(speedSlider.value);
      speedValue.textContent = interval + " ms";
      if(simulation) startSimulation(); // restart with new speed
    });
  </script>
</body>
</html>
